(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function i(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=i(o);fetch(o.href,l)}})();function Q(){const n=document.getElementById("game-canvas"),e=document.getElementById("import-input"),i=document.getElementById("duration-input"),r=document.getElementById("duration-label"),o=document.getElementById("time-mode-toggle-btn"),l=document.getElementById("animate-btn"),d=document.getElementById("pause-btn"),a=document.getElementById("insert-keyframe-btn"),f=document.getElementById("mode-btn"),t=document.getElementById("ik-mode-btn"),h=document.getElementById("onion-btn"),s=document.getElementById("full-onion-skin-btn"),g=document.getElementById("motion-trail-step-input"),T=document.getElementById("export-btn"),I=document.getElementById("import-btn"),S=document.getElementById("onion-before-input"),E=document.getElementById("onion-after-input");if(!n||!e||!i||!r||!o||!l||!d||!a||!f||!t||!h||!s||!g||!T||!I||!S||!E)throw new Error("Could not find all required DOM elements.");return{canvas:n,importInput:e,durationInput:i,durationLabel:r,timeModeToggleBtn:o,animateBtn:l,pauseBtn:d,insertKeyframeBtn:a,modeBtn:f,ikModeBtn:t,onionBtn:h,fullOnionSkinBtn:s,motionTrailStepInput:g,exportBtn:T,importBtn:I,onionBeforeInput:S,onionAfterInput:E}}function ee(n,e){return{stickFigurePose:JSON.parse(JSON.stringify(n.defaultPose)),keyframes:[],activeKeyframeIndex:null,activeKeyframeIndexBeforeAnimation:null,groundY:e.GROUND_Y_POSITION,verticalGuideX:50,draggedPointKey:null,isDraggingGround:!1,isDraggingVerticalGuide:!1,draggedMarkerIndex:null,isDraggingPlayhead:!1,draggedThumbnailIndex:null,currentMousePos:null,hoveredThumbnailIndex:null,hoveredDeleteIconIndex:null,hoveredScrollLeft:!1,hoveredScrollRight:!1,hoveredGround:!1,hoveredVerticalGuide:!1,hoveredMarkerIndex:null,hoveredPlayhead:!1,scrollOffset:0,dropTargetIndex:null,isOnionModeEnabled:!1,onionSkinBefore:5,onionSkinAfter:5,isFullOnionSkinEnabled:!1,motionTrailResolution:1,onionTrailCanvas:null,isAnimating:!1,isPaused:!1,animationMode:"loop",animationRequestId:null,animationStartTime:null,timeElapsedBeforePause:0,animationTotalDuration:5e3,animationProgress:0,timeDisplayMode:"seconds",isIKModeEnabled:!1,draggedEndEffector:null}}function ne(n,e,i,r,o,l,d,a){n.save(),n.strokeStyle="rgba(255, 255, 255, 0.4)",n.lineWidth=1,n.setLineDash([4,4]),n.beginPath(),n.moveTo(0,e),n.lineTo(r,e),n.stroke(),n.beginPath(),n.moveTo(i,0),n.lineTo(i,o),n.stroke(),n.setLineDash([]),n.lineCap="butt",n.lineWidth=d?8:5,n.strokeStyle=d?"rgba(255, 255, 0, 1)":"rgba(255, 255, 255, 0.6)",n.beginPath(),n.moveTo(0,e),n.lineTo(l,e),n.stroke(),n.lineWidth=a?8:5,n.strokeStyle=a?"rgba(255, 255, 0, 1)":"rgba(255, 255, 255, 0.6)",n.beginPath(),n.moveTo(i,o-l),n.lineTo(i,o),n.stroke(),n.restore()}function G(n,e,i={}){n.strokeStyle=i.strokeStyle||"#FFFFFF",n.lineWidth=3,n.lineCap="round",n.beginPath(),n.arc(e.head.x,e.head.y,20,0,Math.PI*2),n.stroke(),n.beginPath(),n.moveTo(e.head.x,e.head.y+20),n.lineTo(e.neck.x,e.neck.y),n.lineTo(e.hip.x,e.hip.y),n.stroke(),n.beginPath(),n.moveTo(e.neck.x,e.neck.y),n.lineTo(e.leftElbow.x,e.leftElbow.y),n.lineTo(e.leftHand.x,e.leftHand.y),n.moveTo(e.neck.x,e.neck.y),n.lineTo(e.rightElbow.x,e.rightElbow.y),n.lineTo(e.rightHand.x,e.rightHand.y),n.stroke(),n.fillStyle=i.fillStyle||"#FFFFFF";const r=8;n.beginPath(),n.arc(e.leftHand.x,e.leftHand.y,r,0,Math.PI*2),n.fill(),n.beginPath(),n.arc(e.rightHand.x,e.rightHand.y,r,0,Math.PI*2),n.fill(),n.beginPath(),n.moveTo(e.hip.x,e.hip.y),n.lineTo(e.leftKnee.x,e.leftKnee.y),n.lineTo(e.leftFoot.x,e.leftFoot.y),n.moveTo(e.hip.x,e.hip.y),n.lineTo(e.rightKnee.x,e.rightKnee.y),n.lineTo(e.rightFoot.x,e.rightFoot.y),n.moveTo(e.leftFoot.x,e.leftFoot.y),n.lineTo(e.leftToe.x,e.leftToe.y),n.moveTo(e.rightFoot.x,e.rightFoot.y),n.lineTo(e.rightToe.x,e.rightToe.y),n.stroke()}function ie(n,e,i,r,o=!1){if(!r)return!1;n.fillStyle="rgba(255, 255, 0, 0.3)",n.strokeStyle="rgba(255, 255, 0, 0.5)",n.lineWidth=2;let l=!1;for(const d in e){const a=e[d];if(Math.hypot(r.x-a.x,r.y-a.y)<i){if(o){if(!["leftHand","rightHand","leftFoot","rightFoot","leftToe","rightToe"].includes(d))continue;n.fillStyle="rgba(0, 255, 255, 0.4)",n.strokeStyle="rgba(0, 255, 255, 0.8)"}else n.fillStyle="rgba(255, 255, 0, 0.3)",n.strokeStyle="rgba(255, 255, 0, 0.5)";n.beginPath(),n.arc(a.x,a.y,i,0,Math.PI*2),n.fill(),n.stroke(),l=!0}}return l}function F(n,e,i,r){const o={hip:{...n.hip}},l=["hip"];for(;l.length>0;){const d=l.shift(),a=o[d],f=r[d]||[];for(const t of f){const h=n.angles[t],s=i[`${t}-${d}`];h!==void 0&&s!==void 0&&(o[t]={x:a.x+Math.cos(h)*s,y:a.y+Math.sin(h)*s},l.push(t))}}return o}function oe(n,e){const i={hip:{...n.hip},angles:{}};for(const r in e){const o=e[r],l=n[r],d=n[o],a=l.x-d.x,f=l.y-d.y;i.angles[r]=Math.atan2(f,a)}return i}function re(n,e){const i=n/2,r=e/2,o={head:{x:i,y:r-80},neck:{x:i,y:r-40},hip:{x:i,y:r+20},leftElbow:{x:i-30,y:r-20},leftHand:{x:i-60,y:r+10},rightElbow:{x:i+30,y:r-20},rightHand:{x:i+60,y:r+10},leftKnee:{x:i-20,y:r+65},leftFoot:{x:i-30,y:r+110},leftToe:{x:i-50,y:r+110},rightKnee:{x:i+20,y:r+65},rightFoot:{x:i+30,y:r+110},rightToe:{x:i+50,y:r+110}},l={neck:"hip",head:"neck",leftElbow:"neck",rightElbow:"neck",leftHand:"leftElbow",rightHand:"rightElbow",leftKnee:"hip",rightKnee:"hip",leftFoot:"leftKnee",rightFoot:"rightKnee",leftToe:"leftFoot",rightToe:"rightFoot"},d={};for(const t in l){const h=l[t];d[h]||(d[h]=[]),d[h].push(t)}const a={};for(const t in l){const h=t,s=l[h];a[`${h}-${s}`]=Math.hypot(o[h].x-o[s].x,o[h].y-o[s].y)}const f=oe(o,l);return{hierarchy:l,children:d,boneLengths:a,defaultPose:f}}function W(n){return{x:n.x+n.width-18-3,y:n.y+3,width:18,height:18}}function X(n,e){const r=e.x+n.time*e.width,o=e.y+e.height/2;return{x:r-16/2,y:o-16/2,width:16,height:16}}function le(n,e,i,r,o,l,d,a=!1){const f=l||a;n.fillStyle=f?"#444":r?"#888":"#666",n.fillRect(e.x,e.y,e.width,e.height);const t=d||a;n.fillStyle=t?"#444":o?"#888":"#666",n.fillRect(i.x,i.y,i.width,i.height),n.lineWidth=3,n.lineCap="round",n.lineJoin="round";const h=e.width*.2,s=e.height*.25;n.strokeStyle=f?"#666":"#FFF",n.beginPath(),n.moveTo(e.x+e.width/2+h,e.y+e.height/2-s),n.lineTo(e.x+e.width/2-h,e.y+e.height/2),n.lineTo(e.x+e.width/2+h,e.y+e.height/2+s),n.stroke(),n.strokeStyle=t?"#666":"#FFF",n.beginPath(),n.moveTo(i.x+i.width/2-h,i.y+i.height/2-s),n.lineTo(i.x+i.width/2+h,i.y+i.height/2),n.lineTo(i.x+i.width/2-h,i.y+i.height/2+s),n.stroke()}function ae(n,e,i,r,o,l,d,a,f,t,h,s,g,T,I,S,E){if(T!==null&&g!==null){const y=T-d;if(y>=0&&y<=e.length){let b;if(y<e.length)b=e[y].x-I/2;else{const p=e[e.length-1];b=p.x+p.width+I/2}i.length>0&&e.length>0&&(n.save(),n.fillStyle="#f0ad4e",n.fillRect(b-1.5,e[0].y,3,e[0].height),n.restore())}}e.forEach((y,b)=>{const p=d+b;if(!(p>=i.length)){if(n.save(),p===g&&(n.globalAlpha=.4),n.fillStyle="#000",n.fillRect(y.x,y.y,y.width,y.height),n.strokeStyle="#555",p===o?(n.strokeStyle="#f0ad4e",n.shadowColor="#f0ad4e",n.shadowBlur=10):p===l&&!t&&(n.strokeStyle="#777"),n.lineWidth=2,n.strokeRect(y.x,y.y,y.width,y.height),n.shadowBlur=0,i[p]){const N=p===o&&o!==null?r:i[p].pose,_=F(N,h.hierarchy,h.boneLengths,h.children),w=n;w.save(),w.translate(y.x,y.y),w.scale(y.width/a,y.height/f),G(w,_),w.restore(),n.fillStyle="rgba(255, 255, 255, 0.9)",n.font="bold 12px sans-serif",n.textAlign="left",n.textBaseline="top",n.fillText(String(p+1),y.x+4,y.y+4);const R=i[p];let x="";E==="seconds"?x=`${(R.time*S/1e3).toFixed(1)}s`:x=`${Math.round(R.time*(S/1e3)*60)}f`,n.fillStyle="rgba(255, 255, 255, 0.8)",n.font="11px sans-serif",n.textAlign="right",n.textBaseline="bottom",n.fillText(x,y.x+y.width-4,y.y+y.height-4);const k=W(y),C=p===s&&!t;n.save(),n.fillStyle=C?"#e63946":"rgba(200, 50, 50, 0.8)",n.strokeStyle="#FFFFFF",n.lineWidth=1.5,n.beginPath(),n.roundRect(k.x,k.y,k.width,k.height,[4]),n.fill();const P=5;n.beginPath(),n.moveTo(k.x+P,k.y+P),n.lineTo(k.x+k.width-P,k.y+k.height-P),n.moveTo(k.x+k.width-P,k.y+P),n.lineTo(k.x+P,k.y+k.height-P),n.stroke(),n.restore()}n.restore()}})}function de(n,e,i){const{keyframes:r,activeKeyframeIndex:o,hoveredMarkerIndex:l,isAnimating:d,animationProgress:a,isPaused:f,hoveredPlayhead:t}=i;if(n.fillStyle="#111",n.fillRect(e.x,e.y,e.width,e.height),n.strokeStyle="#555",n.lineWidth=1,n.strokeRect(e.x,e.y,e.width,e.height),r.forEach((h,s)=>{const g=X(h,e),T=s===l&&!d,I=s===o,S=s>0&&s<r.length-1;n.save(),n.translate(g.x+g.width/2,g.y+g.height/2),n.rotate(Math.PI/4);let E="#888";S||(E="#555"),I&&(E="#f0ad4e"),T&&S&&(E="#ec9b2e"),n.fillStyle=E,n.strokeStyle="#FFF",n.lineWidth=I||T?2:1,n.beginPath(),n.rect(-g.width/2,-g.height/2,g.width,g.height),n.fill(),n.stroke(),n.restore()}),r.length>0){const h=e.x+a*e.width,s=!d||f,g=s&&t;n.save(),n.strokeStyle=g?"#64faff":"#3498db",n.lineWidth=g?4:2,n.beginPath(),n.moveTo(h,e.y-4),n.lineTo(h,e.y+e.height+4),n.stroke(),s&&(n.fillStyle=g?"#64faff":"#3498db",n.beginPath(),n.arc(h,e.y+e.height/2,g?8:6,0,Math.PI*2),n.fill()),n.restore()}}function se(n,e){const r=e-180,o=396,a=r+5+65+5,f={x:50,y:a,width:n-100,height:12},t=100,h=75,s=a+f.height+5,g=10,T=5,I=40,S=T*t+(T-1)*g,E=(n-S)/2,y=Array.from({length:T},(_,w)=>({x:E+w*(t+g),y:s,width:t,height:h})),b=40,p={x:E-b-g,y:s,width:b,height:h},N={x:E+S+g,y:s,width:b,height:h};return{UI_PANEL_HEIGHT:180,POSING_AREA_HEIGHT:r,GROUND_Y_POSITION:o,TIMELINE_RECT:f,THUMBNAIL_RECTS:y,VISIBLE_THUMBNAILS:T,SCROLL_LEFT_BUTTON_RECT:p,SCROLL_RIGHT_BUTTON_RECT:N,GUIDE_GRABBER_SIZE:I,THUMBNAIL_GAP:g}}function fe(n,e,i,r,o,l){const d=r.POSING_AREA_HEIGHT;n.fillStyle="#222",n.fillRect(0,d,e,r.UI_PANEL_HEIGHT),n.strokeStyle="#444",n.lineWidth=1,n.strokeRect(0,d,e,r.UI_PANEL_HEIGHT),o.keyframes.length>0&&de(n,r.TIMELINE_RECT,o),ae(n,r.THUMBNAIL_RECTS,o.keyframes,o.stickFigurePose,o.activeKeyframeIndex,o.hoveredThumbnailIndex,o.scrollOffset,e,r.POSING_AREA_HEIGHT,o.isAnimating,l,o.hoveredDeleteIconIndex,o.draggedThumbnailIndex,o.dropTargetIndex,r.THUMBNAIL_GAP,o.animationTotalDuration,o.timeDisplayMode);const a=o.scrollOffset===0,f=o.scrollOffset>=o.keyframes.length-r.VISIBLE_THUMBNAILS;le(n,r.SCROLL_LEFT_BUTTON_RECT,r.SCROLL_RIGHT_BUTTON_RECT,o.hoveredScrollLeft,o.hoveredScrollRight,a,f,o.isAnimating)}function te(n,e,i,r,o,l){if(n.clearRect(0,0,e.width,e.height),i.activeKeyframeIndex!==null&&(n.save(),n.fillStyle="rgba(255, 255, 255, 0.7)",n.font="16px sans-serif",n.textAlign="left",n.textBaseline="top",n.fillText(`Keyframe: ${i.activeKeyframeIndex+1} / ${i.keyframes.length}`,15,15),n.restore()),ne(n,i.groundY,i.verticalGuideX,e.width,r.POSING_AREA_HEIGHT,r.GUIDE_GRABBER_SIZE,i.hoveredGround,i.hoveredVerticalGuide),i.isAnimating&&i.onionTrailCanvas&&n.drawImage(i.onionTrailCanvas,0,0),i.isOnionModeEnabled&&i.activeKeyframeIndex!==null){const t=i.activeKeyframeIndex,h=.4,s=(I,S,E)=>{var y;if(I>=0&&I<i.keyframes.length){const b=(y=i.keyframes[I])==null?void 0:y.pose;if(b&&b.hip&&b.angles){const p=h/S;if(p>.05){const N=F(b,o.hierarchy,o.boneLengths,o.children),_=`rgba(${E}, ${p})`;G(n,N,{strokeStyle:_,fillStyle:_})}}}},g="255, 87, 34",T="33, 150, 243";for(let I=1;I<=i.onionSkinBefore;I++)s(t-I,I,g);for(let I=1;I<=i.onionSkinAfter;I++)s(t+I,I,T)}const d=F(i.stickFigurePose,o.hierarchy,o.boneLengths,o.children);G(n,d);const f=!i.isAnimating&&!i.draggedMarkerIndex&&ie(n,d,15,i.currentMousePos,i.isIKModeEnabled);fe(n,e.width,e.height,r,i,o),i.draggedThumbnailIndex!==null?e.style.cursor="grabbing":i.isAnimating&&!i.isPaused?e.style.cursor="default":i.isDraggingPlayhead?e.style.cursor="grabbing":i.isDraggingGround?e.style.cursor="ns-resize":i.isDraggingVerticalGuide?e.style.cursor="ew-resize":i.draggedMarkerIndex!==null?e.style.cursor="grabbing":i.hoveredThumbnailIndex!==null&&i.hoveredDeleteIconIndex===null?e.style.cursor="grab":i.hoveredPlayhead?e.style.cursor="ew-resize":i.hoveredGround?e.style.cursor="ns-resize":i.hoveredVerticalGuide?e.style.cursor="ew-resize":i.hoveredMarkerIndex!==null?e.style.cursor="grab":f||i.hoveredDeleteIconIndex!==null||i.hoveredScrollLeft||i.hoveredScrollRight?e.style.cursor="pointer":e.style.cursor="default"}function z(n,e,i){return n*(1-i)+e*i}function he(n,e,i){const r=e-n;return Math.abs(r)>Math.PI&&(r>0?n+=2*Math.PI:e+=2*Math.PI),z(n,e,i)}function me(n,e,i){const r={};for(const l in n.angles)e.angles[l]!==void 0?r[l]=he(n.angles[l],e.angles[l],i):r[l]=n.angles[l];return{hip:{x:z(n.hip.x,e.hip.x,i),y:z(n.hip.y,e.hip.y,i)},angles:r}}function Y(n,e){if(e.length===0)return null;if(e.length===1)return JSON.parse(JSON.stringify(e[0].pose));let i=-1;for(let r=0;r<e.length-1;r++)if(n>=e[r].time&&n<=e[r+1].time){i=r;break}if(i===-1)return n>=1?JSON.parse(JSON.stringify(e[e.length-1].pose)):JSON.parse(JSON.stringify(e[0].pose));{const r=i+1,o=e[i],l=e[r],d=l.time-o.time,a=n-o.time,f=d===0?1:Math.min(1,a/d);return me(o.pose,l.pose,f)}}function Z(n){if(n.keyframes.length===0)return;const e=Y(n.animationProgress,n.keyframes);e&&(n.stickFigurePose=e)}function ge(n,e,i,r){if(!n.isFullOnionSkinEnabled||n.keyframes.length<2){n.onionTrailCanvas=null;return}const o=document.createElement("canvas");o.width=i.width,o.height=r.POSING_AREA_HEIGHT;const l=o.getContext("2d");if(!l){n.onionTrailCanvas=null;return}l.clearRect(0,0,o.width,o.height);const d=Math.floor(n.animationTotalDuration/1e3*60);if(d<2){n.onionTrailCanvas=null;return}const a=n.motionTrailResolution,f=Math.floor(d/a);if(f<=0){n.onionTrailCanvas=null;return}const h=`rgba(200, 225, 255, ${Math.max(.01,Math.min(.25,15/f))})`;for(let s=0;s<d;s+=a){const g=s/(d-1),T=Y(g,n.keyframes);if(T){const I=F(T,e.hierarchy,e.boneLengths,e.children);G(l,I,{strokeStyle:h,fillStyle:h})}}n.onionTrailCanvas=o}function U(n,e,i){if(!e.isAnimating||e.animationStartTime===null||e.keyframes.length<2)return;const r=e.animationMode==="ping-pong"?e.animationTotalDuration*2:e.animationTotalDuration,o=(n-e.animationStartTime)%r;let l;e.animationMode==="ping-pong"&&o>e.animationTotalDuration?l=(e.animationTotalDuration-(o-e.animationTotalDuration))/e.animationTotalDuration:l=o/e.animationTotalDuration,e.animationProgress=l,Z(e),i(),e.isAnimating&&(e.animationRequestId=requestAnimationFrame(d=>U(d,e,i)))}function ue(n,e,i,r,o,l){n.keyframes.length<2||(ge(n,r,l,o),n.isAnimating=!0,n.isPaused=!1,n.timeElapsedBeforePause=0,n.animationStartTime=performance.now(),n.activeKeyframeIndexBeforeAnimation=n.activeKeyframeIndex,n.activeKeyframeIndex=null,e(),n.animationRequestId=requestAnimationFrame(d=>U(d,n,i)))}function ce(n,e){n.animationRequestId&&cancelAnimationFrame(n.animationRequestId),n.animationRequestId=null,n.isAnimating=!1,n.isPaused=!1,n.onionTrailCanvas=null,n.activeKeyframeIndex=n.activeKeyframeIndexBeforeAnimation,n.activeKeyframeIndex!==null&&n.keyframes[n.activeKeyframeIndex]?(n.stickFigurePose=JSON.parse(JSON.stringify(n.keyframes[n.activeKeyframeIndex].pose)),n.animationProgress=n.keyframes[n.activeKeyframeIndex].time):n.keyframes.length>0?(n.activeKeyframeIndex=0,n.stickFigurePose=JSON.parse(JSON.stringify(n.keyframes[0].pose)),n.animationProgress=n.keyframes[0].time):n.animationProgress=0,e()}function ye(n,e){!n.isAnimating||n.isPaused||(n.animationRequestId&&cancelAnimationFrame(n.animationRequestId),n.animationRequestId=null,n.isPaused=!0,n.animationStartTime&&(n.timeElapsedBeforePause=performance.now()-n.animationStartTime),e())}function Ie(n,e,i){!n.isAnimating||!n.isPaused||(n.isPaused=!1,n.animationStartTime&&(n.animationStartTime=performance.now()-n.timeElapsedBeforePause),e(),n.animationRequestId=requestAnimationFrame(r=>U(r,n,i)))}function Te(n){const e=n.length;if(!(e<1)){if(e===1){n[0].time=0;return}n.forEach((i,r)=>{i.time=r/(e-1)})}}function H(n){n.activeKeyframeIndex!==null&&n.keyframes[n.activeKeyframeIndex]&&(n.keyframes[n.activeKeyframeIndex].pose=JSON.parse(JSON.stringify(n.stickFigurePose)))}function ve(n,e){H(n);const i={pose:JSON.parse(JSON.stringify(n.stickFigurePose)),time:0},r=n.activeKeyframeIndex===null?n.keyframes.length:n.activeKeyframeIndex+1;let o;if(n.keyframes.length===0)o=0;else{const d=r<n.keyframes.length?n.keyframes[r]:null;if(d){const a=n.keyframes[r-1];o=a.time+(d.time-a.time)/2}else{const a=n.keyframes[n.keyframes.length-1],f=n.animationTotalDuration,s=a.time*f+1e3;if(n.animationTotalDuration=s,s>0)for(const g of n.keyframes)g.time=g.time*f/s;o=1}}i.time=o,n.keyframes.splice(r,0,i),n.activeKeyframeIndex=r,n.animationProgress=o;const l=n.activeKeyframeIndex;l!==null&&(l<n.scrollOffset?n.scrollOffset=l:l>=n.scrollOffset+e.VISIBLE_THUMBNAILS&&(n.scrollOffset=l-e.VISIBLE_THUMBNAILS+1))}function pe(n,e,i,r){H(n);const o=e===n.keyframes.length-1,l=n.animationTotalDuration;if(n.activeKeyframeIndex===e&&(n.activeKeyframeIndex=null,n.stickFigurePose=JSON.parse(JSON.stringify(i)),n.animationProgress=0,n.isOnionModeEnabled=!1),n.keyframes.splice(e,1),n.activeKeyframeIndex!==null&&n.activeKeyframeIndex>e&&n.activeKeyframeIndex--,n.keyframes.length===0)n.animationTotalDuration=5e3;else if(n.keyframes.length===1)n.keyframes[0].time=0;else if(o){const a=n.keyframes[n.keyframes.length-1].time*l;if(a>0&&l>0){n.animationTotalDuration=a;for(const f of n.keyframes)f.time=f.time*l/a}else n.keyframes.forEach(f=>f.time=0)}n.hoveredDeleteIconIndex=null,n.scrollOffset=Math.max(0,Math.min(n.scrollOffset,n.keyframes.length-r.VISIBLE_THUMBNAILS))}function Ee(n,e,i){const r={pose:JSON.parse(JSON.stringify(e)),time:i};return n.keyframes.push(r),n.keyframes.sort((o,l)=>o.time-l.time),n.keyframes.indexOf(r)}function $(n,e){const i=n.getBoundingClientRect();return{x:e.clientX-i.left,y:e.clientY-i.top}}function B(n,e){return n.x>e.x&&n.x<e.x+e.width&&n.y>e.y&&n.y<e.y+e.height}function ke(n){if(n.length===0){console.warn("No keyframes to export.");return}const e={version:"1.0.0",format:"stick-figure-animation",exportedAt:new Date().toISOString(),keyframes:n,metadata:{totalKeyframes:n.length,duration:n.length>1?n[n.length-1].time-n[0].time:0,hasIKSupport:!0}},i=JSON.stringify(e,null,2),r=new Blob([i],{type:"application/json"}),o=URL.createObjectURL(r),l=document.createElement("a");l.href=o,l.download="stick-figure-animation.json",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)}function V(n){return n.angles&&n.angles.leftToe===void 0&&(n.angles.leftToe=Math.PI),n.angles&&n.angles.rightToe===void 0&&(n.angles.rightToe=0),n}function Se(n){return new Promise((e,i)=>{const r=new FileReader;r.onload=o=>{var l;try{const d=(l=o.target)==null?void 0:l.result;if(typeof d!="string")throw new Error("Failed to read file.");const a=JSON.parse(d);let f=[];if(a.version&&a.format==="stick-figure-animation"&&a.keyframes)if(console.log(`Loading animation file version ${a.version}`),Array.isArray(a.keyframes))f=a.keyframes.map(t=>({...t,pose:V(t.pose)}));else throw new Error("Invalid versioned keyframe file: keyframes array missing.");else if(Array.isArray(a)){if(a.length===0){e([]);return}if(a[0].pose!==void 0&&typeof a[0].time=="number")console.log("Loading legacy new format (array of Keyframes)"),f=a.map(t=>({...t,pose:V(t.pose)}));else if(a[0].hip!==void 0&&a[0].angles!==void 0){console.log("Loading legacy old format (array of StickFigurePose)");const t=a.length;f=a.map((h,s)=>({pose:V(h),time:t<=1?0:s/(t-1)}))}else throw new Error("Unrecognized keyframe file format.")}else throw new Error("Invalid keyframe file: not a valid format.");if(f.some(t=>{var h,s,g;return typeof((s=(h=t.pose)==null?void 0:h.hip)==null?void 0:s.x)!="number"||typeof((g=t.pose)==null?void 0:g.angles)!="object"}))throw new Error("Invalid keyframe file format.");e(f)}catch(d){console.error("Error loading keyframes:",d),i(d)}},r.onerror=()=>{i(new Error("Error reading file."))},r.readAsText(n)})}function be(n,e,i,r){const o=n.x-e.x,l=n.y-e.y,d=Math.hypot(o,l),a=Math.max(1e-6,Math.min(d,i+r-1e-6)),f=Math.acos((i*i+a*a-r*r)/(2*i*a)),t=Math.acos((i*i+r*r-a*a)/(2*i*r)),s=Math.atan2(l,o)-f,g=s+(Math.PI-t);return[s,g]}function Pe(n,e,i,r){const o=JSON.parse(JSON.stringify(i)),l=F(i,r.hierarchy,r.boneLengths,r.children),a={leftHand:{base:"neck",joints:["leftElbow","leftHand"]},rightHand:{base:"neck",joints:["rightElbow","rightHand"]},leftFoot:{base:"hip",joints:["leftKnee","leftFoot"]},rightFoot:{base:"hip",joints:["rightKnee","rightFoot"]},leftToe:{base:"leftFoot",joints:["leftToe"]},rightToe:{base:"rightFoot",joints:["rightToe"]}}[e];if(!a)return null;const f=l[a.base];if(!f)return null;if(a.joints.length===1){const t=a.joints[0];if(r.boneLengths[`${t}-${a.base}`]!==void 0){const s=n.x-f.x,g=n.y-f.y;o.angles[t]=Math.atan2(g,s)}}else if(a.joints.length===2){const[t,h]=a.joints,s=r.boneLengths[`${t}-${a.base}`],g=r.boneLengths[`${h}-${t}`];if(s!==void 0&&g!==void 0){const T=be(n,f,s,g);T&&(o.angles[t]=T[0],o.angles[h]=T[1])}}return o}function q(n){return["leftHand","rightHand","leftFoot","rightFoot","leftToe","rightToe"].includes(n)}function Me(n,e,i,r,o,l){const{canvas:d,animateBtn:a,pauseBtn:f,modeBtn:t,ikModeBtn:h,onionBtn:s,exportBtn:g,importBtn:T,importInput:I,durationInput:S,onionBeforeInput:E,onionAfterInput:y,insertKeyframeBtn:b,timeModeToggleBtn:p,fullOnionSkinBtn:N,motionTrailStepInput:_}=n,{defaultPose:w,hierarchy:R,boneLengths:x,children:k}=r,C=15,P=10;a.addEventListener("click",()=>{e.isAnimating?ce(e,o):e.keyframes.length>=2&&(H(e),ue(e,o,l,r,i,d))}),f.addEventListener("click",()=>{e.isAnimating&&(e.isPaused?Ie(e,o,l):ye(e,o))}),b.addEventListener("click",()=>{if(b.disabled)return;const u=Ee(e,e.stickFigurePose,e.animationProgress);e.animationRequestId&&cancelAnimationFrame(e.animationRequestId),e.animationRequestId=null,e.isAnimating=!1,e.isPaused=!1,e.activeKeyframeIndex=u,e.activeKeyframeIndex<e.scrollOffset?e.scrollOffset=e.activeKeyframeIndex:e.activeKeyframeIndex>=e.scrollOffset+i.VISIBLE_THUMBNAILS&&(e.scrollOffset=e.activeKeyframeIndex-i.VISIBLE_THUMBNAILS+1),o()}),t.addEventListener("click",()=>{e.keyframes.length<2||(e.animationMode=e.animationMode==="loop"?"ping-pong":"loop",o())}),h.addEventListener("click",()=>{e.isAnimating||(e.isIKModeEnabled=!e.isIKModeEnabled,e.draggedEndEffector=null,o())}),s.addEventListener("click",()=>{e.isAnimating||e.activeKeyframeIndex===null||(e.isOnionModeEnabled=!e.isOnionModeEnabled,o())}),N.addEventListener("click",()=>{N.disabled||(e.isFullOnionSkinEnabled=!e.isFullOnionSkinEnabled,o())}),_.addEventListener("change",()=>{const u=parseInt(_.value,10);!isNaN(u)&&u>=1?e.motionTrailResolution=u:_.value=e.motionTrailResolution.toString()}),E.addEventListener("change",()=>{const u=parseInt(E.value,10);!isNaN(u)&&u>=0?(e.onionSkinBefore=u,e.isOnionModeEnabled&&o()):E.value=e.onionSkinBefore.toString()}),y.addEventListener("change",()=>{const u=parseInt(y.value,10);!isNaN(u)&&u>=0?(e.onionSkinAfter=u,e.isOnionModeEnabled&&o()):y.value=e.onionSkinAfter.toString()}),g.addEventListener("click",()=>{e.isAnimating||e.keyframes.length===0||(H(e),ke(e.keyframes))}),T.addEventListener("click",()=>{e.isAnimating||I.click()}),I.addEventListener("change",async u=>{var c;const m=(c=u.target.files)==null?void 0:c[0];if(m)try{H(e);const v=await Se(m);e.keyframes=v,e.scrollOffset=0,e.keyframes.length>0?(e.activeKeyframeIndex=0,e.stickFigurePose=JSON.parse(JSON.stringify(e.keyframes[0].pose)),e.animationProgress=e.keyframes[0].time):(e.activeKeyframeIndex=null,e.stickFigurePose=JSON.parse(JSON.stringify(w)),e.animationProgress=0),e.isOnionModeEnabled=!1,o()}catch{alert("Failed to load keyframes. Please check the file format.")}u.target.value=""}),p.addEventListener("click",()=>{e.isAnimating||(e.timeDisplayMode=e.timeDisplayMode==="seconds"?"frames":"seconds",o())}),S.addEventListener("change",()=>{if(e.timeDisplayMode==="seconds"){const u=parseFloat(S.value);!isNaN(u)&&u>0?e.animationTotalDuration=u*1e3:alert("Invalid duration. Please enter a positive number.")}else{const u=parseInt(S.value,10);!isNaN(u)&&u>0?e.animationTotalDuration=u/60*1e3:alert("Invalid duration. Please enter a positive integer for frames.")}o()}),d.addEventListener("mousedown",u=>{const m=$(d,u);if(e.isAnimating&&!e.isPaused)return;if(e.hoveredPlayhead){e.isDraggingPlayhead=!0,e.activeKeyframeIndex=null,o();return}if(e.hoveredMarkerIndex!==null){e.activeKeyframeIndex!==e.hoveredMarkerIndex&&(H(e),e.activeKeyframeIndex=e.hoveredMarkerIndex,e.stickFigurePose=JSON.parse(JSON.stringify(e.keyframes[e.hoveredMarkerIndex].pose)),e.animationProgress=e.keyframes[e.hoveredMarkerIndex].time,e.activeKeyframeIndex<e.scrollOffset?e.scrollOffset=e.activeKeyframeIndex:e.activeKeyframeIndex>=e.scrollOffset+i.VISIBLE_THUMBNAILS&&(e.scrollOffset=e.activeKeyframeIndex-i.VISIBLE_THUMBNAILS+1)),e.hoveredMarkerIndex>0&&e.hoveredMarkerIndex<e.keyframes.length-1&&(e.draggedMarkerIndex=e.hoveredMarkerIndex),o();return}const c={x:0,y:e.groundY-P,width:i.GUIDE_GRABBER_SIZE,height:P*2};if(B(m,c)&&m.y<i.POSING_AREA_HEIGHT){e.isDraggingGround=!0;return}const v={x:e.verticalGuideX-P,y:i.POSING_AREA_HEIGHT-i.GUIDE_GRABBER_SIZE,width:P*2,height:i.GUIDE_GRABBER_SIZE};if(B(m,v)&&m.y<i.POSING_AREA_HEIGHT){e.isDraggingVerticalGuide=!0;return}if(e.hoveredDeleteIconIndex!==null){pe(e,e.hoveredDeleteIconIndex,w,i),o();return}if(B(m,i.SCROLL_LEFT_BUTTON_RECT)){e.scrollOffset=Math.max(0,e.scrollOffset-1),o();return}if(B(m,i.SCROLL_RIGHT_BUTTON_RECT)){e.scrollOffset=Math.min(e.scrollOffset+1,Math.max(0,e.keyframes.length-i.VISIBLE_THUMBNAILS)),o();return}for(let D=0;D<i.THUMBNAIL_RECTS.length;D++){const K=e.scrollOffset+D;if(B(m,i.THUMBNAIL_RECTS[D])&&e.keyframes[K]){e.activeKeyframeIndex!==K&&(H(e),e.activeKeyframeIndex=K,e.stickFigurePose=JSON.parse(JSON.stringify(e.keyframes[K].pose)),e.animationProgress=e.keyframes[K].time),e.draggedThumbnailIndex=K,o();return}}const M=F(e.stickFigurePose,R,x,k);let A=null,j=1/0;for(const D in M){const K=D,J=Math.hypot(m.x-M[K].x,m.y-M[K].y);J<C&&J<j&&(j=J,A=K)}e.isIKModeEnabled&&A&&!q(A)&&(A=null),e.draggedPointKey=A,e.draggedEndEffector=e.isIKModeEnabled&&A&&q(A)?A:null,!e.draggedPointKey&&m.y<i.POSING_AREA_HEIGHT&&(ve(e,i),o())}),d.addEventListener("mousemove",u=>{const m=$(d,u);if(e.currentMousePos=m,e.draggedThumbnailIndex!==null){e.dropTargetIndex=null;for(let c=0;c<i.THUMBNAIL_RECTS.length;c++){const v=i.THUMBNAIL_RECTS[c],M=e.scrollOffset+c;if(!(M>=e.keyframes.length)&&B(m,v)){if(M===e.draggedThumbnailIndex)e.dropTargetIndex=null;else{const A=v.x+v.width/2;e.dropTargetIndex=m.x<A?M:M+1}break}}o();return}if(e.isDraggingPlayhead){const c=i.TIMELINE_RECT;let v=(m.x-c.x)/c.width;v=Math.max(0,Math.min(1,v)),e.animationProgress=v,e.timeElapsedBeforePause=e.animationProgress*e.animationTotalDuration,Z(e),o();return}if(e.draggedMarkerIndex!==null){const c=i.TIMELINE_RECT;let v=(m.x-c.x)/c.width;const M=e.keyframes[e.draggedMarkerIndex-1].time,A=e.keyframes[e.draggedMarkerIndex+1].time;v=Math.max(M,Math.min(v,A)),e.keyframes[e.draggedMarkerIndex].time=v,o();return}if(e.isDraggingGround){e.groundY=Math.max(0,Math.min(m.y,i.POSING_AREA_HEIGHT)),o();return}if(e.isDraggingVerticalGuide){e.verticalGuideX=Math.max(0,Math.min(m.x,d.width)),o();return}if(e.hoveredScrollLeft=!1,e.hoveredScrollRight=!1,e.hoveredThumbnailIndex=null,e.hoveredDeleteIconIndex=null,e.hoveredMarkerIndex=null,e.hoveredGround=!1,e.hoveredVerticalGuide=!1,e.hoveredPlayhead=!1,!e.isAnimating||e.isPaused){if(e.keyframes.length>0){const v={x:i.TIMELINE_RECT.x+e.animationProgress*i.TIMELINE_RECT.width-6,y:i.TIMELINE_RECT.y-6,width:12,height:i.TIMELINE_RECT.height+12};B(m,v)&&(e.hoveredPlayhead=!0)}e.hoveredScrollLeft=B(m,i.SCROLL_LEFT_BUTTON_RECT),e.hoveredScrollRight=B(m,i.SCROLL_RIGHT_BUTTON_RECT);for(let c=0;c<e.keyframes.length;c++){const v=X(e.keyframes[c],i.TIMELINE_RECT);if(B(m,v)){e.hoveredMarkerIndex=c;break}}if(m.y<i.POSING_AREA_HEIGHT){const c={x:0,y:e.groundY-P,width:i.GUIDE_GRABBER_SIZE,height:P*2},v={x:e.verticalGuideX-P,y:i.POSING_AREA_HEIGHT-i.GUIDE_GRABBER_SIZE,width:P*2,height:i.GUIDE_GRABBER_SIZE};B(m,c)?e.hoveredGround=!0:B(m,v)&&(e.hoveredVerticalGuide=!0)}for(let c=0;c<i.THUMBNAIL_RECTS.length;c++){const v=i.THUMBNAIL_RECTS[c],M=e.scrollOffset+c;if(e.keyframes[M]&&B(m,v)){e.hoveredThumbnailIndex=M;const A=W(v);if(B(m,A)){e.hoveredDeleteIconIndex=M,e.hoveredThumbnailIndex=null;break}}}}if(e.draggedPointKey)if(m.y=Math.min(m.y,i.POSING_AREA_HEIGHT-2),e.isIKModeEnabled&&e.draggedEndEffector){const c=Pe(m,e.draggedEndEffector,e.stickFigurePose,r);c&&(e.stickFigurePose=c)}else if(e.draggedPointKey==="hip")e.stickFigurePose.hip=m;else{const c=R[e.draggedPointKey],M=F(e.stickFigurePose,R,x,k)[c],A=Math.atan2(m.y-M.y,m.x-M.x);e.stickFigurePose.angles[e.draggedPointKey]=A}o()}),d.addEventListener("mouseup",()=>{if(e.draggedThumbnailIndex!==null&&e.dropTargetIndex!==null){const u=e.draggedThumbnailIndex;let m=e.dropTargetIndex;const[c]=e.keyframes.splice(u,1);u<m&&m--,e.keyframes.splice(m,0,c),e.activeKeyframeIndex=m,Te(e.keyframes),e.keyframes[m]&&(e.animationProgress=e.keyframes[m].time)}e.draggedPointKey=null,e.draggedEndEffector=null,e.isDraggingGround=!1,e.isDraggingVerticalGuide=!1,e.draggedMarkerIndex=null,e.isDraggingPlayhead=!1,e.draggedThumbnailIndex=null,e.dropTargetIndex=null,o()}),d.addEventListener("mouseleave",()=>{e.draggedPointKey=null,e.draggedEndEffector=null,e.isDraggingGround=!1,e.isDraggingVerticalGuide=!1,e.draggedMarkerIndex=null,e.isDraggingPlayhead=!1,e.draggedThumbnailIndex=null,e.dropTargetIndex=null,e.currentMousePos=null,(!e.isAnimating||e.isPaused)&&(e.hoveredScrollLeft=!1,e.hoveredScrollRight=!1,e.hoveredThumbnailIndex=null,e.hoveredDeleteIconIndex=null,e.hoveredGround=!1,e.hoveredVerticalGuide=!1,e.hoveredMarkerIndex=null,e.hoveredPlayhead=!1),o()}),window.addEventListener("keydown",u=>{if(!(e.isAnimating||document.activeElement&&document.activeElement.tagName==="INPUT"||e.isDraggingGround||e.isDraggingVerticalGuide||e.draggedMarkerIndex!==null)&&(u.key==="ArrowLeft"||u.key==="ArrowRight")){if(u.preventDefault(),e.keyframes.length===0)return;let m;e.activeKeyframeIndex===null?m=u.key==="ArrowLeft"?e.keyframes.length-1:0:m=u.key==="ArrowLeft"?e.activeKeyframeIndex-1:e.activeKeyframeIndex+1,m>=0&&m<e.keyframes.length&&(H(e),e.activeKeyframeIndex=m,e.stickFigurePose=JSON.parse(JSON.stringify(e.keyframes[e.activeKeyframeIndex].pose)),e.animationProgress=e.keyframes[e.activeKeyframeIndex].time,e.activeKeyframeIndex<e.scrollOffset?e.scrollOffset=e.activeKeyframeIndex:e.activeKeyframeIndex>=e.scrollOffset+i.VISIBLE_THUMBNAILS&&(e.scrollOffset=e.activeKeyframeIndex-i.VISIBLE_THUMBNAILS+1),o())}})}const O=(n,e="0 0 24 24")=>`<svg xmlns="http://www.w3.org/2000/svg" viewBox="${e}" width="22" height="22" fill="currentColor">${n}</svg>`,L={play:O('<path d="M8 5v14l11-7z"/>'),pause:O('<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>'),stop:O('<path d="M6 6h12v12H6z"/>'),insert:O('<path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>'),loop:O('<path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/>'),pingpong:O('<path d="M8 4l-4 4 4 4V9h8v3l4-4-4-4v3H8V4zm8 13v-3h-8V9l-4 4 4 4v-3h8v3z" />'),onion:O('<path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5C21.27 7.61 17 4.5 12 4.5zm0 12c-2.48 0-4.5-2.02-4.5-4.5S9.52 7.5 12 7.5s4.5 2.02 4.5 4.5-2.02 4.5-4.5 4.5zm0-7C10.62 9.5 9.5 10.62 9.5 12s1.12 2.5 2.5 2.5 2.5-1.12 2.5-2.5S13.38 9.5 12 9.5z"/>'),export:O('<path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>'),import:O('<path d="M9 16h6v-6h4l-7-7-7 7h4v6zm-4 2h14v2H5v-2z"/>'),motionTrail:O('<path d="M4 6v12h2V6H4zm5 0v12h2V6H9zm5 0v12h2V6h-2z"/>'),ik:O('<path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>')};function Ae(n,e){n.animateBtn.innerHTML=e.isAnimating?L.stop:L.play,n.animateBtn.title=e.isAnimating?"Stop Animation":"Animate",n.animateBtn.disabled=e.keyframes.length<2&&!e.isAnimating,n.pauseBtn.innerHTML=e.isPaused?L.play:L.pause,n.pauseBtn.title=e.isPaused?"Resume":"Pause",n.pauseBtn.disabled=!e.isAnimating,n.ikModeBtn.classList.toggle("active",e.isIKModeEnabled),n.ikModeBtn.title=e.isIKModeEnabled?"Disable IK Mode":"Enable IK Mode",n.ikModeBtn.disabled=e.isAnimating;const i=e.keyframes.some(f=>Math.abs(f.time-e.animationProgress)<1e-4),r=e.isAnimating&&e.isPaused,o=!e.isAnimating&&e.activeKeyframeIndex===null&&e.keyframes.length>=2,l=r||e.isDraggingPlayhead||o;n.insertKeyframeBtn.disabled=!l||i,n.modeBtn.innerHTML=e.animationMode==="loop"?L.loop:L.pingpong,n.modeBtn.title=`Mode: ${e.animationMode==="loop"?"Loop":"Ping-Pong"}`,n.modeBtn.disabled=e.keyframes.length<2;const d=e.isAnimating||e.activeKeyframeIndex===null;n.onionBtn.disabled=d,n.onionBtn.classList.toggle("active",e.isOnionModeEnabled&&!d),n.onionBeforeInput.disabled=d,n.onionAfterInput.disabled=d;const a=e.isAnimating;if(n.fullOnionSkinBtn.disabled=a,n.fullOnionSkinBtn.classList.toggle("active",e.isFullOnionSkinEnabled&&!a),n.motionTrailStepInput.disabled=a,n.motionTrailStepInput.value=e.motionTrailResolution.toString(),n.exportBtn.disabled=e.isAnimating||e.keyframes.length===0,n.importBtn.disabled=e.isAnimating,n.timeModeToggleBtn.disabled=e.isAnimating,n.timeModeToggleBtn.textContent=e.timeDisplayMode==="seconds"?"Use Frames":"Use Seconds",e.timeDisplayMode==="seconds")n.durationLabel.textContent="Duration (s):",n.durationInput.value=(e.animationTotalDuration/1e3).toFixed(1),n.durationInput.step="0.1",n.durationInput.min="0.1";else{const f=Math.round(e.animationTotalDuration/1e3*60);n.durationLabel.textContent="Duration (f):",n.durationInput.value=String(f),n.durationInput.step="1",n.durationInput.min="1"}n.durationInput.disabled=e.isAnimating}function Be(){const n=Q(),{canvas:e,insertKeyframeBtn:i,onionBtn:r,exportBtn:o,importBtn:l,fullOnionSkinBtn:d,ikModeBtn:a}=n;e.width=800,e.height=720;const f=e.getContext("2d");if(!f)return;const t=se(e.width,e.height),h=re(e.width,t.POSING_AREA_HEIGHT),s=ee(h,t),g=()=>te(f,e,s,t,h),T=()=>{Ae(n,s),g()};i.innerHTML=L.insert,r.innerHTML=L.onion,d.innerHTML=L.motionTrail,o.innerHTML=L.export,l.innerHTML=L.import,a.innerHTML=L.ik,Me(n,s,t,h,T,g),T()}Be();
